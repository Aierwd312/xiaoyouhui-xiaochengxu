{"version":3,"file":"login.js","sources":["pages/login.vue","../../../../Program Files/HBuilderX.4.76.2025082103/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"normal-login-container\">\r\n    <view class=\"logo-content align-center justify-center flex\">\r\n      <image style=\"width: 100rpx;height: 100rpx;\" :src=\"globalConfig.appInfo.logo\" mode=\"widthFix\">\r\n      </image>\r\n      <text class=\"title\">若依移动端登录</text>\r\n    </view>\r\n    <view class=\"login-form-content\">\r\n      <view class=\"input-item flex align-center\">\r\n        <view class=\"iconfont icon-user icon\"></view>\r\n        <input v-model=\"loginForm.username\" class=\"input\" type=\"text\" placeholder=\"请输入账号\" maxlength=\"30\" />\r\n      </view>\r\n      <view class=\"input-item flex align-center\">\r\n        <view class=\"iconfont icon-password icon\"></view>\r\n        <input v-model=\"loginForm.password\" type=\"password\" class=\"input\" placeholder=\"请输入密码\" maxlength=\"20\" />\r\n      </view>\r\n      <view class=\"input-item flex align-center\" style=\"width: 60%;margin: 0px;\" v-if=\"captchaEnabled\">\r\n        <view class=\"iconfont icon-code icon\"></view>\r\n        <input v-model=\"loginForm.code\" type=\"number\" class=\"input\" placeholder=\"请输入验证码\" maxlength=\"4\" />\r\n        <view class=\"login-code\"> \r\n          <image :src=\"codeUrl\" @click=\"getCode\" class=\"login-code-img\"></image>\r\n        </view  >\r\n      </view>\r\n      <view class=\"action-btn\">\r\n        <button @click=\"handleLogin\" class=\"login-btn cu-btn block bg-blue lg round\">登录</button>\r\n      </view>\r\n    </view>\r\n\r\n    <view class=\"xieyi text-center\">\r\n      <text class=\"text-grey1\">登录即代表同意</text>\r\n      <text @click=\"handleUserAgrement\" class=\"text-blue\">《用户协议》</text>\r\n      <text @click=\"handlePrivacy\" class=\"text-blue\">《隐私协议》</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\n\timport { getCodeImg } from '@/api/login'\r\n\timport { ref } from \"vue\";\r\n\timport user from '@/store/modules/user'\r\n\timport config from '@/config.js'\r\n\timport store from '@/store'\r\n\tconst codeUrl=ref(\"\");\r\n\tconst captchaEnabled=ref(true);\r\n\tconst globalConfig=ref(config);\r\n\tconst loginForm=ref({\r\n\t        username: \"admin\",\r\n\t        password: \"admin123\",\r\n\t        code: \"\",\r\n\t        uuid: ''\r\n\t      });\r\n\t// 隐私协议\r\n\tfunction handlePrivacy() {\r\n\t  let site = globalConfig.value.appInfo.agreements[0];\r\n\t  uni.navigateTo({\r\n\t  \turl: `/pages/common/webview/index?title=${site.title}&url=${site.url}`\r\n\t  });\r\n\t};\r\n\t// 用户协议\r\n\tfunction handleUserAgrement() {\r\n\t  let site = globalConfig.value.appInfo.agreements[1]\r\n\t  uni.navigateTo({\r\n\t  \turl: `/pages/common/webview/index?title=${site.title}&url=${site.url}`\r\n\t  });\r\n\t};\r\n\t\t  \r\n\t// 获取图形验证码\r\n\tfunction getCode() {\r\n\t  getCodeImg().then(res => {\r\n\t    captchaEnabled.value = res.captchaEnabled === undefined ? true : res.captchaEnabled\r\n\t    if (captchaEnabled.value) {\r\n\t      codeUrl.value = 'data:image/gif;base64,' + res.img\r\n\t      loginForm.value.uuid = res.uuid\r\n\t    }\r\n\t  })\r\n\t};\r\n\t\r\n\tasync function handleLogin() {\r\n\t\t  if (loginForm.value.username === \"\") {\r\n\t\t\t  uni.showToast({\r\n\t\t\t    title: '请输入您的账号',\r\n\t\t\t    mask: false,\r\n\t\t\t    duration: 1000\r\n\t\t\t  });\r\n\t\t      //this.$modal.msgError(\"请输入您的账号\")\r\n\t\t    } else if (loginForm.value.password === \"\") {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '请输入您的密码',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.msgError(\"请输入您的密码\")\r\n\t\t    } else if (loginForm.value.code === \"\" && captchaEnabled.value) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '请输入验证码',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.msgError(\"请输入验证码\")\r\n\t\t    } else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '登录中，请耐心等待...',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.loading(\"登录中，请耐心等待...\")\r\n\t\t      pwdLogin()\r\n\t\t    }\r\n\t\t};\r\n\t// 密码登录\r\n\tasync function pwdLogin() {\r\n\t\t   /* this.$modal.closeLoading() */\r\n\t\tstore.dispatch('Login', loginForm.value).then(() => {\r\n\t\t\tloginSuccess()\r\n\t\t\t}).catch(() => {\r\n\t\t\t  if (captchaEnabled.value) {\r\n\t\t\t    getCode()\r\n\t\t\t  }\r\n\t\t\t})\r\n\t};\r\n\t\r\n\tfunction loginSuccess(result) {\r\n\t  // 设置用户信息\r\n\t  store.dispatch('GetInfo').then(res => {\r\n\r\n\t\t\t  uni.navigateTo({\r\n\t\t  \turl: '/pages/index/index'\r\n\t\t  });\r\n\t  })\r\n\t}\r\n\t\r\n\tgetCode();\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  page {\r\n    background-color: #ffffff;\r\n  }\r\n\r\n  .normal-login-container {\r\n    width: 100%;\r\n\r\n    .logo-content {\r\n      width: 100%;\r\n      font-size: 21px;\r\n      text-align: center;\r\n      padding-top: 15%;\r\n\r\n      image {\r\n        border-radius: 4px;\r\n      }\r\n\r\n      .title {\r\n        margin-left: 10px;\r\n      }\r\n    }\r\n\r\n    .login-form-content {\r\n      text-align: center;\r\n      margin: 20px auto;\r\n      margin-top: 15%;\r\n      width: 80%;\r\n\r\n      .input-item {\r\n        margin: 20px auto;\r\n        background-color: #f5f6f7;\r\n        height: 45px;\r\n        border-radius: 20px;\r\n\r\n        .icon {\r\n          font-size: 38rpx;\r\n          margin-left: 10px;\r\n          color: #999;\r\n        }\r\n\r\n        .input {\r\n          width: 100%;\r\n          font-size: 14px;\r\n          line-height: 20px;\r\n          text-align: left;\r\n          padding-left: 15px;\r\n        }\r\n\r\n      }\r\n\r\n      .login-btn {\r\n        margin-top: 40px;\r\n        height: 45px;\r\n      }\r\n\r\n      .xieyi {\r\n        color: #333;\r\n        margin-top: 20px;\r\n      }\r\n      \r\n      .login-code {\r\n        height: 38px;\r\n        float: right;\r\n      \r\n        .login-code-img {\r\n          height: 38px;\r\n          position: absolute;\r\n          margin-left: 10px;\r\n          width: 200rpx;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import MiniProgramPage from 'D:/Projects/XBuider/校友会/ruoyi-app-vue3/pages/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","config","uni","getCodeImg","store","MiniProgramPage"],"mappings":";;;;;;;;;AA0CC,UAAM,UAAQA,kBAAI,EAAE;AACpB,UAAM,iBAAeA,kBAAI,IAAI;AAC7B,UAAM,eAAaA,kBAAIC,OAAAA,MAAM;AAC7B,UAAM,YAAUD,cAAAA,IAAI;AAAA,MACZ,UAAU;AAAA,MACV,UAAU;AAAA,MACV,MAAM;AAAA,MACN,MAAM;AAAA,IACf,CAAQ;AAEP,aAAS,gBAAgB;AACvB,UAAI,OAAO,aAAa,MAAM,QAAQ,WAAW,CAAC;AAClDE,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qCAAqC,KAAK,KAAK,QAAQ,KAAK,GAAG;AAAA,MACxE,CAAI;AAAA,IAEJ;AACC,aAAS,qBAAqB;AAC5B,UAAI,OAAO,aAAa,MAAM,QAAQ,WAAW,CAAC;AAClDA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qCAAqC,KAAK,KAAK,QAAQ,KAAK,GAAG;AAAA,MACxE,CAAI;AAAA,IAEJ;AAEC,aAAS,UAAU;AACjBC,2BAAY,EAAC,KAAK,SAAO;AACvB,uBAAe,QAAQ,IAAI,mBAAmB,SAAY,OAAO,IAAI;AACrE,YAAI,eAAe,OAAO;AACxB,kBAAQ,QAAQ,2BAA2B,IAAI;AAC/C,oBAAU,MAAM,OAAO,IAAI;AAAA,QAC5B;AAAA,MACN,CAAI;AAAA,IAEJ;AACC,mBAAe,cAAc;AAC1B,UAAI,UAAU,MAAM,aAAa,IAAI;AACpCD,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACjB,CAAM;AAAA,MAEC,WAAU,UAAU,MAAM,aAAa,IAAI;AAC9CA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAAA,MAEL,WAAiB,UAAU,MAAM,SAAS,MAAM,eAAe,OAAO;AAClEA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAAA,MAEL,OAAa;AACTA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAEG,iBAAU;AAAA,MACX;AAAA,IAEP;AACC,mBAAe,WAAW;AAEzBE,kBAAK,MAAC,SAAS,SAAS,UAAU,KAAK,EAAE,KAAK,MAAM;AACnD,qBAAc;AAAA,MACjB,CAAI,EAAE,MAAM,MAAM;AACb,YAAI,eAAe,OAAO;AACxB,kBAAS;AAAA,QACV;AAAA,MACN,CAAI;AAAA,IAEJ;AACC,aAAS,aAAa,QAAQ;AAE5BA,kBAAAA,MAAM,SAAS,SAAS,EAAE,KAAK,SAAO;AAEpCF,sBAAAA,MAAI,WAAW;AAAA,UACf,KAAK;AAAA,QACV,CAAK;AAAA,MACL,CAAI;AAAA,IACF;AAED;;;;;;;;;;;;;;;;;;;;;;AClID,GAAG,WAAWG,SAAe;"}