{"version":3,"file":"login.js","sources":["pages/login.vue","../../../../Program Files/HBuilderX.4.76.2025082103/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <!-- Logo区域 -->\r\n    <view class=\"logo-section\">\r\n      <view class=\"logo-content\">\r\n        <image src=\"/static/school-badge.svg\" class=\"logo-image svg-icon svg-white\"></image>\r\n        <text class=\"app-title\">重财校友会</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 登录表单卡片 -->\r\n    <view class=\"login-card\">\r\n      <view class=\"card-header\">\r\n        <text class=\"login-title\">登录</text>\r\n      </view>\r\n      \r\n      <view class=\"form-content\">\r\n        <view class=\"input-item\">\r\n          <view class=\"input-wrapper\">\r\n            <view class=\"iconfont icon-user input-icon\"></view>\r\n            <input v-model=\"loginForm.username\" class=\"input-field\" type=\"text\" placeholder=\"请输入账号\" maxlength=\"30\" />\r\n          </view>\r\n        </view>\r\n        \r\n        <view class=\"input-item\">\r\n          <view class=\"input-wrapper\">\r\n            <view class=\"iconfont icon-password input-icon\"></view>\r\n            <input v-model=\"loginForm.password\" type=\"password\" class=\"input-field\" placeholder=\"请输入密码\" maxlength=\"20\" />\r\n          </view>\r\n        </view>\r\n        \r\n        <view class=\"input-item captcha-item\" v-if=\"captchaEnabled\">\r\n          <view class=\"input-wrapper\">\r\n            <view class=\"iconfont icon-code input-icon\"></view>\r\n            <input v-model=\"loginForm.code\" type=\"number\" class=\"input-field captcha-input\" placeholder=\"请输入验证码\" maxlength=\"4\" />\r\n            <view class=\"captcha-image-wrapper\">\r\n              <image :src=\"codeUrl\" @click=\"getCode\" class=\"captcha-image\"></image>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        \r\n        <view class=\"login-btn-wrapper\">\r\n          <button @click=\"handleLogin\" class=\"login-btn\">登录</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 协议区域 -->\r\n    <view class=\"agreement-section\">\r\n      <text class=\"agreement-text\">登录即代表同意</text>\r\n      <text @click=\"handleUserAgrement\" class=\"agreement-link\">《用户协议》</text>\r\n      <text @click=\"handlePrivacy\" class=\"agreement-link\">《隐私协议》</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\n\timport { getCodeImg } from '@/api/login'\r\n\timport { ref } from \"vue\";\r\n\timport user from '@/store/modules/user'\r\n\timport config from '@/config.js'\r\n\timport store from '@/store'\r\n\tconst codeUrl=ref(\"\");\r\n\tconst captchaEnabled=ref(true);\r\n\tconst globalConfig=ref(config);\r\n\tconst loginForm=ref({\r\n\t        username: \"\",\r\n\t        password: \"\",\r\n\t        code: \"\",\r\n\t        uuid: ''\r\n\t      });\r\n\t// 隐私协议\r\n\tfunction handlePrivacy() {\r\n\t  let site = globalConfig.value.appInfo.agreements[0];\r\n\t  uni.navigateTo({\r\n\t  \turl: `/pages/common/webview/index?title=${site.title}&url=${site.url}`\r\n\t  });\r\n\t};\r\n\t// 用户协议\r\n\tfunction handleUserAgrement() {\r\n\t  let site = globalConfig.value.appInfo.agreements[1]\r\n\t  uni.navigateTo({\r\n\t  \turl: `/pages/common/webview/index?title=${site.title}&url=${site.url}`\r\n\t  });\r\n\t};\r\n\t\t  \r\n\t// 获取图形验证码\r\n\tfunction getCode() {\r\n\t  getCodeImg().then(res => {\r\n\t    captchaEnabled.value = res.captchaEnabled === undefined ? true : res.captchaEnabled\r\n\t    if (captchaEnabled.value) {\r\n\t      codeUrl.value = 'data:image/gif;base64,' + res.img\r\n\t      loginForm.value.uuid = res.uuid\r\n\t    }\r\n\t  })\r\n\t};\r\n\t\r\n\tasync function handleLogin() {\r\n\t\t  if (loginForm.value.username === \"\") {\r\n\t\t\t  uni.showToast({\r\n\t\t\t    title: '请输入您的账号',\r\n\t\t\t    mask: false,\r\n\t\t\t    duration: 1000\r\n\t\t\t  });\r\n\t\t      //this.$modal.msgError(\"请输入您的账号\")\r\n\t\t    } else if (loginForm.value.password === \"\") {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '请输入您的密码',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.msgError(\"请输入您的密码\")\r\n\t\t    } else if (loginForm.value.code === \"\" && captchaEnabled.value) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '请输入验证码',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.msgError(\"请输入验证码\")\r\n\t\t    } else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: '登录中，请耐心等待...',\r\n\t\t\t\t  mask: false,\r\n\t\t\t\t  duration: 1000\r\n\t\t\t\t});\r\n\t\t      //this.$modal.loading(\"登录中，请耐心等待...\")\r\n\t\t      pwdLogin()\r\n\t\t    }\r\n\t\t};\r\n\t// 密码登录\r\n\tasync function pwdLogin() {\r\n\t\t   /* this.$modal.closeLoading() */\r\n\t\tstore.dispatch('Login', loginForm.value).then(() => {\r\n\t\t\tloginSuccess()\r\n\t\t\t}).catch(() => {\r\n\t\t\t  if (captchaEnabled.value) {\r\n\t\t\t    getCode()\r\n\t\t\t  }\r\n\t\t\t})\r\n\t};\r\n\t\r\n\tfunction loginSuccess(result) {\r\n\t  // 设置用户信息\r\n\t  store.dispatch('GetInfo').then(res => {\r\n\r\n\t\t\t  uni.navigateTo({\r\n\t\t  \turl: '/pages/index/index'\r\n\t\t  });\r\n\t  })\r\n\t}\r\n\t\r\n\tgetCode();\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n/* 全局样式 */\r\npage {\r\n  margin: 0;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n  font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n  background-color: #004299;\r\n}\r\n\r\n/* 登录容器 - 匹配index页面背景 */\r\n.login-container {\r\n  min-height: 100vh;\r\n  background-color: #004299;\r\n  background-image: linear-gradient(135deg, #004299 0%, #2A6DCF 100%);\r\n  padding: 0 32rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n}\r\n\r\n/* Logo区域 */\r\n.logo-section {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  justify-content: center;\r\n  padding-top: 60rpx;\r\n  padding-bottom: 80rpx;\r\n}\r\n\r\n.logo-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  text-align: center;\r\n}\r\n\r\n.logo-image {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.app-title {\r\n  font-size: 48rpx;\r\n  font-weight: 600;\r\n  color: white;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n/* 登录卡片 - 匹配index页面卡片样式 */\r\n.login-card {\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 8px 40rpx rgba(0, 0, 0, 0.15);\r\n  overflow: hidden;\r\n  margin-bottom: 60rpx;\r\n  backdrop-filter: blur(10rpx);\r\n  border: 1px solid rgba(255, 255, 255, 0.2);\r\n}\r\n\r\n.card-header {\r\n  padding: 48rpx 48rpx 24rpx 48rpx;\r\n  text-align: center;\r\n}\r\n\r\n.login-title {\r\n  font-size: 48rpx;\r\n  font-weight: 600;\r\n  color: #333333;\r\n}\r\n\r\n/* 表单内容 */\r\n.form-content {\r\n  padding: 0 48rpx 48rpx 48rpx;\r\n}\r\n\r\n.input-item {\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.input-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #f8f9fa;\r\n  border-radius: 24rpx;\r\n  padding: 24rpx 32rpx;\r\n  border: 2rpx solid transparent;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.input-wrapper:focus-within {\r\n  border-color: #004299;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 0 0 6rpx rgba(0, 66, 153, 0.1);\r\n}\r\n\r\n.input-icon {\r\n  font-size: 40rpx;\r\n  color: #666666;\r\n  margin-right: 24rpx;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.input-field {\r\n  flex: 1;\r\n  font-size: 32rpx;\r\n  color: #333333;\r\n  background: transparent;\r\n  border: none;\r\n  outline: none;\r\n}\r\n\r\n.input-field::placeholder {\r\n  color: #999999;\r\n}\r\n\r\n/* 验证码特殊样式 - 修复对齐问题 */\r\n.captcha-item .input-wrapper {\r\n  position: relative;\r\n}\r\n\r\n.captcha-input {\r\n  flex: 1;\r\n  margin-right: 24rpx;\r\n}\r\n\r\n.captcha-image-wrapper {\r\n  flex-shrink: 0;\r\n  width: 200rpx;\r\n  height: 80rpx;\r\n  border-radius: 12rpx;\r\n  overflow: hidden;\r\n  background-color: #f0f0f0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.captcha-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n/* 登录按钮 */\r\n.login-btn-wrapper {\r\n  margin-top: 48rpx;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 96rpx;\r\n  background: linear-gradient(135deg, #004299 0%, #2A6DCF 100%);\r\n  border: none;\r\n  border-radius: 48rpx;\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  box-shadow: 0 8rpx 24rpx rgba(0, 66, 153, 0.3);\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.login-btn:active {\r\n  transform: translateY(2rpx);\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 66, 153, 0.3);\r\n}\r\n\r\n/* 协议区域 */\r\n.agreement-section {\r\n  text-align: center;\r\n  padding-bottom: 60rpx;\r\n  margin-top: auto;\r\n}\r\n\r\n.agreement-text {\r\n  font-size: 28rpx;\r\n  color: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.agreement-link {\r\n  font-size: 28rpx;\r\n  color: white;\r\n  text-decoration: underline;\r\n  margin: 0 8rpx;\r\n}\r\n\r\n/* SVG 图标样式 - 复用index页面的SVG样式 */\r\n.svg-icon {\r\n  display: block;\r\n}\r\n\r\n.svg-icon {\r\n  filter: brightness(0) saturate(100%);\r\n}\r\n\r\n.svg-white {\r\n  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(207deg) brightness(105%) contrast(101%);\r\n}\r\n\r\n/* 响应式调整 */\r\n@media (max-height: 667px) {\r\n  .logo-section {\r\n    padding-top: 40rpx;\r\n    padding-bottom: 60rpx;\r\n  }\r\n  \r\n  .logo-image {\r\n    width: 120rpx;\r\n    height: 120rpx;\r\n  }\r\n  \r\n  .app-title {\r\n    font-size: 40rpx;\r\n  }\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/Projects/XBuider/校友会/xiaoyouhui-xiaochengxu/pages/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","config","uni","getCodeImg","store","MiniProgramPage"],"mappings":";;;;;;;;;;AA8DC,UAAM,UAAQA,kBAAI,EAAE;AACpB,UAAM,iBAAeA,kBAAI,IAAI;AAC7B,UAAM,eAAaA,kBAAIC,OAAAA,MAAM;AAC7B,UAAM,YAAUD,cAAAA,IAAI;AAAA,MACZ,UAAU;AAAA,MACV,UAAU;AAAA,MACV,MAAM;AAAA,MACN,MAAM;AAAA,IACf,CAAQ;AAEP,aAAS,gBAAgB;AACvB,UAAI,OAAO,aAAa,MAAM,QAAQ,WAAW,CAAC;AAClDE,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qCAAqC,KAAK,KAAK,QAAQ,KAAK,GAAG;AAAA,MACxE,CAAI;AAAA,IAEJ;AACC,aAAS,qBAAqB;AAC5B,UAAI,OAAO,aAAa,MAAM,QAAQ,WAAW,CAAC;AAClDA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qCAAqC,KAAK,KAAK,QAAQ,KAAK,GAAG;AAAA,MACxE,CAAI;AAAA,IAEJ;AAEC,aAAS,UAAU;AACjBC,2BAAY,EAAC,KAAK,SAAO;AACvB,uBAAe,QAAQ,IAAI,mBAAmB,SAAY,OAAO,IAAI;AACrE,YAAI,eAAe,OAAO;AACxB,kBAAQ,QAAQ,2BAA2B,IAAI;AAC/C,oBAAU,MAAM,OAAO,IAAI;AAAA,QAC5B;AAAA,MACN,CAAI;AAAA,IAEJ;AACC,mBAAe,cAAc;AAC1B,UAAI,UAAU,MAAM,aAAa,IAAI;AACpCD,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACjB,CAAM;AAAA,MAEC,WAAU,UAAU,MAAM,aAAa,IAAI;AAC9CA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAAA,MAEL,WAAiB,UAAU,MAAM,SAAS,MAAM,eAAe,OAAO;AAClEA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAAA,MAEL,OAAa;AACTA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAEG,iBAAU;AAAA,MACX;AAAA,IAEP;AACC,mBAAe,WAAW;AAEzBE,kBAAK,MAAC,SAAS,SAAS,UAAU,KAAK,EAAE,KAAK,MAAM;AACnD,qBAAc;AAAA,MACjB,CAAI,EAAE,MAAM,MAAM;AACb,YAAI,eAAe,OAAO;AACxB,kBAAS;AAAA,QACV;AAAA,MACN,CAAI;AAAA,IAEJ;AACC,aAAS,aAAa,QAAQ;AAE5BA,kBAAAA,MAAM,SAAS,SAAS,EAAE,KAAK,SAAO;AAEpCF,sBAAAA,MAAI,WAAW;AAAA,UACf,KAAK;AAAA,QACV,CAAK;AAAA,MACL,CAAI;AAAA,IACF;AAED;;;;;;;;;;;;;;;;;;;;;;ACtJD,GAAG,WAAWG,SAAe;"}