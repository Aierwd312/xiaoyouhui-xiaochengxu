{"version":3,"file":"storage.js","sources":["utils/storage.js"],"sourcesContent":["import constant from './constant'\r\n\r\n// 存储变量名\r\nlet storageKey = 'storage_data'\r\n\r\n// 存储节点变量名\r\nlet storageNodeKeys = [constant.avatar, constant.name, constant.roles, constant.permissions]\r\n\r\n// 存储的数据\r\nlet storageData = uni.getStorageSync(storageKey) || {}\r\n\r\nconst storage = {\r\n  set: function(key, value) {\r\n    if (storageNodeKeys.indexOf(key) != -1) {\r\n      let tmp = uni.getStorageSync(storageKey)\r\n      tmp = tmp ? tmp : {}\r\n      tmp[key] = value\r\n      uni.setStorageSync(storageKey, tmp)\r\n    }\r\n  },\r\n  get: function(key) {\r\n    // 每次获取时重新从storage读取，确保数据是最新的\r\n    let tmp = uni.getStorageSync(storageKey) || {}\r\n    return tmp[key] || \"\"\r\n  },\r\n  remove: function(key) {\r\n    let tmp = uni.getStorageSync(storageKey) || {}\r\n    delete tmp[key]\r\n    uni.setStorageSync(storageKey, tmp)\r\n  },\r\n  clean: function() {\r\n    uni.removeStorageSync(storageKey)\r\n  }\r\n}\r\n\r\nexport default storage\r\n"],"names":["constant","uni"],"mappings":";;;AAGA,IAAI,aAAa;AAGjB,IAAI,kBAAkB,CAACA,wBAAS,QAAQA,eAAQ,SAAC,MAAMA,wBAAS,OAAOA,eAAQ,SAAC,WAAW;AAGzEC,cAAAA,MAAI,eAAe,UAAU,KAAK,CAAE;AAEjD,MAAC,UAAU;AAAA,EACd,KAAK,SAAS,KAAK,OAAO;AACxB,QAAI,gBAAgB,QAAQ,GAAG,KAAK,IAAI;AACtC,UAAI,MAAMA,cAAAA,MAAI,eAAe,UAAU;AACvC,YAAM,MAAM,MAAM,CAAE;AACpB,UAAI,GAAG,IAAI;AACXA,0BAAI,eAAe,YAAY,GAAG;AAAA,IACnC;AAAA,EACF;AAAA,EACD,KAAK,SAAS,KAAK;AAEjB,QAAI,MAAMA,cAAG,MAAC,eAAe,UAAU,KAAK,CAAE;AAC9C,WAAO,IAAI,GAAG,KAAK;AAAA,EACpB;AAAA,EACD,QAAQ,SAAS,KAAK;AACpB,QAAI,MAAMA,cAAG,MAAC,eAAe,UAAU,KAAK,CAAE;AAC9C,WAAO,IAAI,GAAG;AACdA,wBAAI,eAAe,YAAY,GAAG;AAAA,EACnC;AAAA,EACD,OAAO,WAAW;AAChBA,kBAAG,MAAC,kBAAkB,UAAU;AAAA,EACjC;AACH;;"}