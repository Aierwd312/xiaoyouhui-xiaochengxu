{"version":3,"names":["fuiQrcode","_sfc_main","components","data","userInfo","name","avatar","studentId","department","className","graduationYear","isVerified","cardNumber","issueDate","qrcodeValue","canvasId","onLoad","getUserInfo","methods","setTimeout","common_vendor","index","__f__","qrcodeReady","e","handleShare","showShareMenu","withShareTicket","menus","success","fail","err","showToast","title","icon","handleSave","canvasToTempFilePath","res","saveImageToPhotosAlbum","filePath","tempFilePath","errMsg","indexOf","showModal","content","showCancel","handleEdit","navigateTo","url","wx","createPage","MiniProgramPage"],"sources":["alumniCardPage.js?vue&type=script&src=true&lang.js","cGFnZXMvYWx1bW5pQ2FyZFBhZ2UvYWx1bW5pQ2FyZFBhZ2UudnVl"],"sourcesContent":["import fuiQrcode from \"@/components/firstui/fui-qrcode/fui-qrcode.vue\"\r\n\r\nexport default {\r\n    components: {\r\n        fuiQrcode\r\n    },\r\n    data() {\r\n        return {\r\n            // 用户个人信息\r\n            userInfo: {\r\n                name: '张三',\r\n                avatar: '/static/images/avatar-default.png',\r\n                studentId: '20170101',\r\n                department: '金融学院',\r\n                className: '金融1班',\r\n                graduationYear: '2021',\r\n                isVerified: true,\r\n                cardNumber: 'CQCF202105260001',\r\n                issueDate: '2023-09-01'\r\n            },\r\n            // 二维码内容\r\n            qrcodeValue: 'https://alumni.cqcfe.edu.cn/card/20170101',\r\n            // 保存二维码的canvasId\r\n            canvasId: ''\r\n        }\r\n    },\r\n    onLoad() {\r\n        // 页面加载时可以从服务器获取用户信息\r\n        this.getUserInfo();\r\n    },\r\n    methods: {\r\n        // 获取用户信息\r\n        getUserInfo() {\r\n            // 实际项目中应该调用API获取用户信息\r\n            // uni.request({\r\n            //     url: 'https://api.example.com/user/alumni-card',\r\n            //     method: 'GET',\r\n            //     success: (res) => {\r\n            //         if (res.statusCode === 200 && res.data) {\r\n            //             this.userInfo = res.data.userInfo;\r\n            //             this.qrcodeValue = res.data.qrcodeValue;\r\n            //         }\r\n            //     },\r\n            //     fail: (err) => {\r\n            //         console.error('获取用户信息失败', err);\r\n            //         uni.showToast({\r\n            //             title: '获取用户信息失败',\r\n            //             icon: 'none'\r\n            //         });\r\n            //     }\r\n            // });\r\n            \r\n            // 模拟获取数据\r\n            setTimeout(() => {\r\n                console.log('用户信息加载完成');\r\n            }, 500);\r\n        },\r\n        \r\n        // 二维码组件初始化完成\r\n        qrcodeReady(e) {\r\n            this.canvasId = e.canvasId;\r\n            console.log('二维码初始化完成，canvasId:', e.canvasId);\r\n        },\r\n        \r\n        // 分享校友卡\r\n        handleShare() {\r\n            uni.showShareMenu({\r\n                withShareTicket: true,\r\n                menus: ['shareAppMessage', 'shareTimeline'],\r\n                success: () => {\r\n                    console.log('显示分享菜单成功');\r\n                },\r\n                fail: (err) => {\r\n                    console.error('显示分享菜单失败', err);\r\n                    uni.showToast({\r\n                        title: '分享功能暂不可用',\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        // 保存校友卡到相册\r\n        handleSave() {\r\n            if (!this.canvasId) {\r\n                uni.showToast({\r\n                    title: '二维码未加载完成',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            \r\n            uni.canvasToTempFilePath({\r\n                canvasId: this.canvasId,\r\n                success: (res) => {\r\n                    uni.saveImageToPhotosAlbum({\r\n                        filePath: res.tempFilePath,\r\n                        success: () => {\r\n                            uni.showToast({\r\n                                title: '校友卡保存成功',\r\n                                icon: 'success'\r\n                            });\r\n                        },\r\n                        fail: (err) => {\r\n                            console.error('保存图片失败', err);\r\n                            if (err.errMsg.indexOf('auth deny') >= 0) {\r\n                                uni.showModal({\r\n                                    title: '提示',\r\n                                    content: '需要您授权保存相册',\r\n                                    showCancel: false\r\n                                });\r\n                            } else {\r\n                                uni.showToast({\r\n                                    title: '保存图片失败',\r\n                                    icon: 'none'\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                },\r\n                fail: (err) => {\r\n                    console.error('生成图片失败', err);\r\n                    uni.showToast({\r\n                        title: '生成图片失败',\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            }, this);\r\n        },\r\n        \r\n        // 编辑校友卡信息\r\n        handleEdit() {\r\n            uni.navigateTo({\r\n                url: '/pages/alumniCardEdit/alumniCardEdit',\r\n                fail: (err) => {\r\n                    console.error('页面跳转失败', err);\r\n                    uni.showToast({\r\n                        title: '编辑功能暂未开放',\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n","import MiniProgramPage from 'D:/Projects/XBuider/校友会/校友会/pages/alumniCardPage/alumniCardPage.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}