{"version":3,"names":["utf16to8","str","len","length","out","i","c","charCodeAt","charAt","String","fromCharCode","canvasId","concat","Math","ceil","random","toString","_sfc_main","name","emits","props","width","type","Number","default","height","value","foreground","background","data","errorCorrectLevel","typeNumber","w","h","computed","initDraw","watch","val","_this","common_vendor","index","upx2px","$nextTick","draw","created","ctx","mounted","_this2","setTimeout","$emit","beforeUnmount","methods","getContext","callback","_this3","query","createSelectorQuery","in","select","fields","node","size","exec","res","canvas","dpr","getSystemInfoSync","pixelRatio","scale","drawQrcode","_this4","clearRect","qrcode","components_firstui_fuiQrcode_fuiQr_index","cells","modules","tileW","tileH","forEach","row","rdx","cell","cdx","fillStyle","floor","fillRect","round","_this5","longtap","touchstart","touchend","wx","createComponent","Component"],"sources":["fui-qrcode.vue","RDovUHJvamVjdHMvWEJ1aWRlci_moKHlj4vkvJov5qCh5Y-L5LyaL2NvbXBvbmVudHMvZmlyc3R1aS9mdWktcXJjb2RlL2Z1aS1xcmNvZGUudnVl"],"sourcesContent":["<template>\r\n\r\n\t<!-- #ifdef APP-NVUE -->\r\n\t<gcanvas @longpress=\"longtap\" @touchstart=\"touchstart\" @touchend=\"touchend\" :ref=\"canvasId\"\r\n\t\t:style=\"{ width: w + 'px', height:h + 'px'  }\">\r\n\t</gcanvas>\r\n\t<!-- #endif -->\r\n\r\n\t<!-- #ifdef MP-QQ -->\r\n\t<canvas canvas-id=\"canvas_qrcode\" :style=\"{width:w+'px',height:h+'px'}\" @longtap=\"longtap\" @touchstart=\"touchstart\"\r\n\t\t@touchend=\"touchend\"></canvas>\r\n\t<!-- #endif -->\r\n\r\n\t<!-- #ifdef MP-WEIXIN -->\r\n\t<canvas type=\"2d\" :canvas-id=\"canvasId\" :id=\"canvasId\" :style=\"{width:w+'px',height:h+'px'}\" @longtap=\"longtap\"\r\n\t\t@touchstart=\"touchstart\" @touchend=\"touchend\" v-if=\"canvasId\"></canvas>\r\n\t<!-- #endif -->\r\n\r\n\t<!-- #ifndef APP-NVUE || MP-QQ || MP-WEIXIN-->\r\n\t<canvas :canvas-id=\"canvasId\" :id=\"canvasId\" :style=\"{width:w+'px',height:h+'px'}\" @longtap=\"longtap\"\r\n\t\t@touchstart=\"touchstart\" @touchend=\"touchend\" v-if=\"canvasId\"></canvas>\r\n\t<!-- #endif -->\r\n\r\n</template>\r\n\r\n<script>\r\n\timport fuiQr from './fui-qr/index.js'\r\n\r\n\t// #ifdef APP-NVUE\r\n\timport {\r\n\t\tenable,\r\n\t\tWeexBridge\r\n\t} from './gcanvas/index.js';\r\n\t// #endif\r\n\r\n\tconst utf16to8 = (str) => {\r\n\t\tconst len = str.length\r\n\t\tlet out = ''\r\n\r\n\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\tconst c = str.charCodeAt(i)\r\n\r\n\t\t\tif ((c >= 0x0001) && (c <= 0x007F)) {\r\n\t\t\t\tout += str.charAt(i)\r\n\t\t\t} else if (c > 0x07FF) {\r\n\t\t\t\tout += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F))\r\n\t\t\t\tout += String.fromCharCode(0x80 | ((c >> 6) & 0x3F))\r\n\t\t\t\tout += String.fromCharCode(0x80 | ((c >> 0) & 0x3F))\r\n\t\t\t} else {\r\n\t\t\t\tout += String.fromCharCode(0xC0 | ((c >> 6) & 0x1F))\r\n\t\t\t\tout += String.fromCharCode(0x80 | ((c >> 0) & 0x3F))\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn out\r\n\t}\r\n\t// #ifdef MP-WEIXIN\r\n\tconst canvasId = `fui_qr_${Math.ceil(Math.random() * 10e5).toString(36)}`\r\n\t// #endif\r\n\r\n\t// #ifdef MP-QQ\r\n\tconst canvasId = 'canvas_qrcode'\r\n\t// #endif\r\n\texport default {\r\n\t\tname: \"fui-qrcode\",\r\n\t\temits: ['ready', 'longclick', 'touchStart', 'touchEnd'],\r\n\t\tprops: {\r\n\t\t\twidth: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 400\r\n\t\t\t},\r\n\t\t\theight: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 400\r\n\t\t\t},\r\n\t\t\tvalue: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\tforeground: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#181818'\r\n\t\t\t},\r\n\t\t\tbackground: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#ffffff'\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\t// #ifndef MP-WEIXIN || MP-QQ\r\n\t\t\tconst canvasId = `fui_qr_${Math.ceil(Math.random() * 10e5).toString(36)}`\r\n\t\t\t// #endif\r\n\t\t\treturn {\r\n\t\t\t\tcanvasId,\r\n\t\t\t\t//误差校正等级\r\n\t\t\t\terrorCorrectLevel: 2,\r\n\t\t\t\t//类型\r\n\t\t\t\ttypeNumber: -1,\r\n\t\t\t\tw: 200,\r\n\t\t\t\th: 200\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tinitDraw() {\r\n\t\t\t\treturn `${this.width}_${this.height}_${this.foreground}_${this.background}_${this.value}`\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tinitDraw(val) {\r\n\t\t\t\tthis.w = uni.upx2px(this.width || 400)\r\n\t\t\t\tthis.h = uni.upx2px(this.height || 400)\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.draw()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.w = uni.upx2px(this.width || 400)\r\n\t\t\tthis.h = uni.upx2px(this.height || 400)\r\n\t\t\tthis.ctx = null;\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.draw()\r\n\t\t\t\t\tthis.$emit('ready', {\r\n\t\t\t\t\t\tcanvasId: this.canvasId\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 50)\r\n\t\t\t})\r\n\t\t},\r\n\t\t// #ifndef VUE3\r\n\t\tbeforeDestroy() {\r\n\t\t\tthis.ctx = null;\r\n\t\t},\r\n\t\t// #endif\r\n\t\t// #ifdef VUE3\r\n\t\tbeforeUnmount() {\r\n\t\t\tthis.ctx = null;\r\n\t\t},\r\n\t\t// #endif\r\n\t\tmethods: {\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\tgetContext(callback) {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this)\r\n\t\t\t\tquery.select(`#${this.canvasId}`)\r\n\t\t\t\t\t.fields({\r\n\t\t\t\t\t\tnode: true,\r\n\t\t\t\t\t\tsize: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec((res) => {\r\n\t\t\t\t\t\tconst canvas = res[0].node\r\n\t\t\t\t\t\tconst ctx = canvas.getContext('2d')\r\n\t\t\t\t\t\tconst dpr = uni.getSystemInfoSync().pixelRatio\r\n\t\t\t\t\t\tcanvas.width = res[0].width * dpr\r\n\t\t\t\t\t\tcanvas.height = res[0].height * dpr\r\n\t\t\t\t\t\tctx.scale(dpr, dpr)\r\n\t\t\t\t\t\tthis.ctx = ctx;\r\n\t\t\t\t\t\tcallback && callback()\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\tdrawQrcode() {\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tthis.ctx.clearRect(0, 0, this.w, this.h);\r\n\t\t\t\t// #endif\r\n\t\t\t\tconst qrcode = fuiQr(utf16to8(this.value), {\r\n\t\t\t\t\ttypeNumber: this.typeNumber,\r\n\t\t\t\t\terrorCorrectLevel: this.errorCorrectLevel,\r\n\t\t\t\t})\r\n\t\t\t\tconst cells = qrcode.modules\r\n\t\t\t\tconst tileW = this.w / cells.length\r\n\t\t\t\tconst tileH = this.h / cells.length\r\n\r\n\t\t\t\tif (!this.ctx) {\r\n\t\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\t\tlet ganvas = this.$refs[this.canvasId];\r\n\t\t\t\t\t/*通过元素引用获取canvas对象*/\r\n\t\t\t\t\tlet canvasObj = enable(ganvas, {\r\n\t\t\t\t\t\tbridge: WeexBridge\r\n\t\t\t\t\t});\r\n\t\t\t\t\t/*获取绘图所需的上下文，暂不支持3d*/\r\n\t\t\t\t\tthis.ctx = canvasObj.getContext('2d');\r\n\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t// #ifndef APP-NVUE || MP-WEIXIN\r\n\t\t\t\t\tthis.ctx = uni.createCanvasContext(this.canvasId, this)\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t}\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tthis.ctx.scale(1, 1)\r\n\t\t\t\t// #endif\r\n\t\t\t\tcells.forEach((row, rdx) => {\r\n\t\t\t\t\trow.forEach((cell, cdx) => {\r\n\t\t\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\t\tthis.ctx.fillStyle = cell ? this.foreground : this.background\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\t\t\tthis.ctx.setFillStyle(cell ? this.foreground : this.background)\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\tconst w = (Math.ceil((cdx + 1) * tileW) - Math.floor(cdx * tileW))\r\n\t\t\t\t\t\tconst h = (Math.ceil((rdx + 1) * tileH) - Math.floor(rdx * tileH))\r\n\t\t\t\t\t\tthis.ctx.fillRect(Math.round(cdx * tileW), Math.round(rdx * tileH), w, h)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tthis.ctx.draw()\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tdraw() {\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tif (!this.ctx) {\r\n\t\t\t\t\tthis.getContext(() => {\r\n\t\t\t\t\t\tthis.drawQrcode()\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.drawQrcode()\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tthis.drawQrcode()\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tlongtap() {\r\n\t\t\t\tthis.$emit('longclick', {})\r\n\t\t\t},\r\n\t\t\ttouchstart() {\r\n\t\t\t\tthis.$emit('touchStart', {})\r\n\t\t\t},\r\n\t\t\ttouchend() {\r\n\t\t\t\tthis.$emit('touchEnd', {})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped></style>","import Component from 'D:/Projects/XBuider/校友会/校友会/components/firstui/fui-qrcode/fui-qrcode.vue'\nwx.createComponent(Component)"],"mappings":"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","ignoreList":[]}